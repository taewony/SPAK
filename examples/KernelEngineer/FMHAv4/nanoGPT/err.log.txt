python train_nanogpt_cutile.py
[WARN] TileGym ops not found. Using PyTorch fallback for orchestration logic.
/home/linux/taewony/SPAK/examples/KernelEngineer/FMHAv4/nanoGPT/train_nanogpt_cutile.py:65: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=(dtype == 'float16'))
Starting NanoGPT cuTile Training on shakespeare_char...
Traceback (most recent call last):
  File "/home/linux/taewony/SPAK/examples/KernelEngineer/FMHAv4/nanoGPT/train_nanogpt_cutile.py", line 90, in <module>
    losses = estimate_loss()
             ^^^^^^^^^^^^^^^
  File "/home/linux/taewony/env/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/linux/taewony/SPAK/examples/KernelEngineer/FMHAv4/nanoGPT/train_nanogpt_cutile.py", line 76, in estimate_loss
    _, loss = model(X, Y)
              ^^^^^^^^^^^
  File "/home/linux/taewony/env/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/linux/taewony/env/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/linux/taewony/SPAK/examples/KernelEngineer/FMHAv4/nanoGPT/nanogpt_cutile.py", line 143, in forward
    x = block(x)
        ^^^^^^^^
  File "/home/linux/taewony/env/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/linux/taewony/env/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/linux/taewony/SPAK/examples/KernelEngineer/FMHAv4/nanoGPT/nanogpt_cutile.py", line 97, in forward
    x = x + self.attn(x_norm1)
            ^^^^^^^^^^^^^^^^^^
  File "/home/linux/taewony/env/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/linux/taewony/env/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/linux/taewony/SPAK/examples/KernelEngineer/FMHAv4/nanoGPT/nanogpt_cutile.py", line 63, in forward
    y = fmha(
        ^^^^^
TypeError: fmha() got an unexpected keyword argument 'kernel_configs'
