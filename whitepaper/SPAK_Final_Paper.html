<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>SPAK_Final_Paper</title>
  <style>

html {
color: #1a1a1a;
background-color: #fdfdfd;
}
body {
margin: 0 auto;
max-width: 36em;
padding-left: 50px;
padding-right: 50px;
padding-top: 50px;
padding-bottom: 50px;
hyphens: auto;
overflow-wrap: break-word;
text-rendering: optimizeLegibility;
font-kerning: normal;
}
@media (max-width: 600px) {
body {
font-size: 0.9em;
padding: 12px;
}
h1 {
font-size: 1.8em;
}
}
@media print {
html {
background-color: white;
}
body {
background-color: transparent;
color: black;
font-size: 12pt;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h2, h3, h4 {
page-break-after: avoid;
}
}
p {
margin: 1em 0;
}
a {
color: #1a1a1a;
}
a:visited {
color: #1a1a1a;
}
img {
max-width: 100%;
}
svg {
height: auto;
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
margin-top: 1.4em;
}
h5, h6 {
font-size: 1em;
font-style: italic;
}
h6 {
font-weight: normal;
}
ol, ul {
padding-left: 1.7em;
margin-top: 1em;
}
li > ol, li > ul {
margin-top: 0;
}
blockquote {
margin: 1em 0 1em 1.7em;
padding-left: 1em;
border-left: 2px solid #e6e6e6;
color: #606060;
}
code {
font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
font-size: 85%;
margin: 0;
hyphens: manual;
}
pre {
margin: 1em 0;
overflow: auto;
}
pre code {
padding: 0;
overflow: visible;
overflow-wrap: normal;
}
.sourceCode {
background-color: transparent;
overflow: visible;
}
hr {
border: none;
border-top: 1px solid #1a1a1a;
height: 1px;
margin: 1em 0;
}
table {
margin: 1em 0;
border-collapse: collapse;
width: 100%;
overflow-x: auto;
display: block;
font-variant-numeric: lining-nums tabular-nums;
}
table caption {
margin-bottom: 0.75em;
}
tbody {
margin-top: 0.5em;
border-top: 1px solid #1a1a1a;
border-bottom: 1px solid #1a1a1a;
}
th {
border-top: 1px solid #1a1a1a;
padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
margin-bottom: 4em;
text-align: center;
}
#TOC li {
list-style: none;
}
#TOC ul {
padding-left: 1.3em;
}
#TOC > ul {
padding-left: 0;
}
#TOC a:not(:hover) {
text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}
.display.math{display: block; text-align: center; margin: 0.5rem auto;}
</style>
</head>
<body>
<h1 id="spak-a-spec-driven-programmable-agent-kernel-for-ai-engineering-education">SPAK:
A Spec-Driven Programmable Agent Kernel for AI Engineering
Education</h1>
<p><strong>Authors:</strong> ÍπÄÌÉúÏõê<br />
<strong>Affiliation:</strong> Ïö∞ÏÜ°ÎåÄÌïôÍµê<br />
<strong>Repository:</strong> https://github.com/taewony/SPAK</p>
<hr />
<h2 id="abstract">Abstract</h2>
<p>The rapid advancement of Large Language Models (LLMs) has accelerated
the development of AI agents, yet current prompt-driven methodologies
suffer from non-deterministic outputs, lack of interpretability, and
difficulty in verification. This paper introduces the
<strong>Spec-driven Programmable Agent Kernel (SPAK)</strong>, a novel
architecture that treats AI software synthesis as a formal compilation
process rather than probabilistic text generation. SPAK introduces three
key innovations: (1) <strong>AgentSpec</strong>, a semantic
Domain-Specific Language (DSL) that formalizes agent structure, state,
effects, and workflows as mathematical objects; (2) an <strong>Algebraic
Effect-based Runtime Kernel</strong>, which isolates decision-making
policy from execution to ensure safety and observability; and (3) an
<strong>Agent Maturity Framework</strong>, a six-level curriculum (Level
0‚Äì5) that systematically guides learners from building simple functions
to complex, self-improving recursive agents. We demonstrate SPAK‚Äôs
efficacy by synthesizing and verifying agents across all maturity levels
on a local PC environment using the <strong>Ollama</strong> inference
tool, showing that formal specifications can reliably bridge the gap
between natural language intent and robust software execution. This work
proposes a shift from <em>prompting agents</em> to <em>programming agent
kernels</em>, offering a foundational platform for both AI engineering
education and dependable agentic systems.</p>
<p><strong>Keywords:</strong> AI Engineering, Agent Kernels, Formal
Specification, Large Language Models, Algebraic Effects, Recursive
Agents, Software Engineering Education.</p>
<hr />
<h2 id="introduction">1. Introduction</h2>
<h3 id="background-from-prompt-engineering-to-agent-engineering">1.1
Background: From Prompt Engineering to Agent Engineering</h3>
<p>The paradigm of AI engineering is shifting from single-turn chat
interfaces toward autonomous agents capable of long-horizon planning,
tool usage, and self-correction. However, most existing development
practices remain rooted in <strong>prompt engineering</strong>, which
relies on empirical tuning of natural language instructions. From a
software engineering perspective, this approach lacks structural
guarantees and fails to ensure <strong>intent preservation</strong>,
<strong>reproducibility</strong>, and
<strong>verifiability</strong>.</p>
<h3 id="problem-statement">1.2 Problem Statement</h3>
<p>Current agent frameworks emphasize behavioral performance while
neglecting formal structure. This results in:</p>
<ul>
<li><strong>Implicit Semantics:</strong> Agent logic is embedded in
unstructured prompts, invisible to static analysis.</li>
<li><strong>Tight Coupling:</strong> State, tools, and control flow are
entangled, hindering reasoning and maintenance.</li>
<li><strong>Pedagogical Fragility:</strong> Learners acquire
model-specific tricks rather than transferable engineering
principles.</li>
</ul>
<p>These limitations make it difficult to scale agent systems reliably
or to teach agent construction systematically.</p>
<h3 id="contribution">1.3 Contribution</h3>
<p>This paper proposes <strong>SPAK (Spec-driven Programmable Agent
Kernel)</strong> as a response to these challenges. SPAK reframes agent
development as a <strong>specification-driven compilation
process</strong>, grounded in formal semantics and category-theoretic
structure.</p>
<p>Our contributions are:</p>
<ol type="1">
<li><strong>AgentSpec DSL:</strong> A semantic specification language
for agents, modeling state, transitions, effects, and invariants
explicitly.</li>
<li><strong>Algebraic Effect Kernel:</strong> A runtime that strictly
separates decision logic from side effects, enabling safety,
observability, and replay.</li>
<li><strong>Agent Maturity Framework:</strong> A six-level curriculum
(Level 0‚Äì5) that incrementally introduces agentic capabilities in a
pedagogically sound manner.</li>
<li><strong>End-to-End Implementation:</strong> A working kernel that
synthesizes, verifies, and executes agents locally using Ollama-based
LLM inference.</li>
</ol>
<hr />
<h2 id="formal-semantics-agents-as-endofunctors">2. Formal Semantics:
Agents as Endofunctors</h2>
<p>SPAK models agents as mathematical objects operating over semantic
state spaces.</p>
<h3 id="semantic-category-mathcalc">2.1 Semantic Category <span class="math inline">ùíû</span></h3>
<p>We define a <strong>Semantic Category</strong> <span class="math inline">ùíû</span> where:</p>
<ul>
<li><strong>Objects:</strong> Immutable snapshots of an agent‚Äôs semantic
state (e.g., memory, goals, context).</li>
<li><strong>Morphisms:</strong> Pure functions <span class="math inline"><em>f</em>‚ÄÑ:‚ÄÑ<em>S</em>‚ÄÑ‚Üí‚ÄÑ<em>S</em><sup>‚Ä≤</sup></span>
representing valid semantic transitions.</li>
</ul>
<h3 id="agent-as-endofunctor">2.2 Agent as Endofunctor</h3>
<p>An agent is modeled as an <strong>Endofunctor</strong> <span class="math inline"><em>F</em>‚ÄÑ:‚ÄÑùíû‚ÄÑ‚Üí‚ÄÑùíû</span> that:</p>
<ul>
<li>Iteratively applies semantic transformations (<span class="math inline"><em>S</em><sub><em>t</em>‚ÄÖ+‚ÄÖ1</sub>‚ÄÑ=‚ÄÑ<em>F</em>(<em>S</em><sub><em>t</em></sub>)</span>).</li>
<li>Preserves structural invariants defined in the specification.</li>
</ul>
<p>This formulation provides a precise notion of <em>intent
preservation</em> as structure preservation under <span class="math inline"><em>F</em></span>.</p>
<h3 id="algebraic-effects">2.3 Algebraic Effects</h3>
<p>Interactions with the external world (LLM calls, file I/O, tools) are
represented as <strong>Algebraic Effects</strong>. Rather than executing
effects directly, agents emit effect requests that are interpreted by
the Kernel. This ensures:</p>
<ul>
<li>Clear separation between <strong>policy</strong> and
<strong>mechanism</strong>.</li>
<li>Deterministic replay and controlled execution.</li>
<li>Compatibility with formal verification techniques.</li>
</ul>
<hr />
<h2 id="agent-maturity-framework">3. Agent Maturity Framework</h2>
<p>To evaluate SPAK as an educational and engineering framework, we
introduce a graded <strong>Agent Maturity Framework</strong>.</p>
<table>
<thead>
<tr>
<th style="text-align: right;">Level</th>
<th>Name</th>
<th>Capability</th>
<th>Formal Concept</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td>Static Responder</td>
<td>Input ‚Üí Output</td>
<td>Morphism</td>
<td>‚úì</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td>Context-Aware Bot</td>
<td>Persistent State</td>
<td>Objects</td>
<td>‚úì</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td>Tool-Use Agent</td>
<td>Side Effects</td>
<td>Algebraic Effects</td>
<td>‚úì</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td>Planning Agent</td>
<td>Control Flow</td>
<td>Endofunctor</td>
<td>‚úì</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td>Multi-Agent System</td>
<td>Coordination</td>
<td>Category Composition</td>
<td>‚úì</td>
</tr>
<tr>
<td style="text-align: right;">5</td>
<td>Self-Improving Agent</td>
<td>Recursive Build</td>
<td>Meta-Endofunctor</td>
<td>‚úì</td>
</tr>
</tbody>
</table>
<p>Each level builds on the previous one, enabling learners to progress
from simple functional mappings to self-recursive agent systems.</p>
<hr />
<h2 id="implementation-and-evaluation">4. Implementation and
Evaluation</h2>
<p>The SPAK system was implemented in Python and evaluated entirely on a
<strong>local PC environment using Ollama</strong> for LLM
inference.</p>
<h3 id="architecture">4.1 Architecture</h3>
<ul>
<li><strong>Compiler:</strong> Parses AgentSpec Markdown into a Semantic
IR using Lark.</li>
<li><strong>Builder:</strong> Uses LLMs to synthesize code and tests
from the IR.</li>
<li><strong>Verifier:</strong> Enforces invariants via static checks and
dynamic test execution.</li>
<li><strong>Runtime:</strong> Executes agents while mediating all
declared effects.</li>
</ul>
<h3 id="case-studies">4.2 Case Studies</h3>
<p>We successfully synthesized and verified agents at all maturity
levels, including:</p>
<ul>
<li><strong>Level 2:</strong> Tool-using agents with complete
side-effect isolation.</li>
<li><strong>Level 3:</strong> Planning agents with self-repair loops
triggered by test failures.</li>
<li><strong>Level 5:</strong> Recursive agents that spawn sub-kernels to
overcome context window limitations.</li>
</ul>
<p>These results demonstrate that formal specifications can reliably
constrain probabilistic LLM behavior.</p>
<hr />
<h2 id="related-work">5. Related Work</h2>
<p>SPAK differs from existing agent frameworks (e.g., LangChain,
MetaGPT, Reflexion) by prioritizing <strong>formal structure and
verifiability</strong> over heuristic orchestration. Unlike traditional
formal methods, SPAK maintains practical usability through a Python-like
DSL and LLM-assisted synthesis.</p>
<hr />
<h2 id="conclusion-and-future-work">6. Conclusion and Future Work</h2>
<p>This paper presented SPAK, a spec-driven programmable agent kernel
that elevates AI agent development from prompt-centric experimentation
to a rigorous engineering discipline. By combining formal semantics,
algebraic effects, and a curriculum-oriented maturity framework, SPAK
enables both reliable system construction and effective AI engineering
education.</p>
<p>Future work will focus on the following directions:</p>
<ol type="1">
<li><strong>Enhanced Meta-Build Capabilities:</strong> Extending Level 5
agents to autonomously refine and optimize their own AgentSpec
definitions through recursive verification and synthesis loops.</li>
<li><strong>Web-Based AI Engineering Playbooks:</strong> Developing
agents that generate interactive web pages documenting design decisions,
specifications, and build trajectories as educational artifacts.</li>
<li><strong>Project-Oriented Learning Agents:</strong> Applying SPAK to
end-to-end educational build projects, such as implementing an LLM
inference engine from scratch, allowing students to experience the full
stack from kernel optimization to agent orchestration.</li>
</ol>
<p>We believe these directions will further strengthen SPAK‚Äôs role as a
foundational platform for scalable, trustworthy, and teachable AI
engineering.</p>
<hr />
<h2 id="references">References</h2>
<p>[1] OpenAI. GPT-4 Technical Report, 2023.<br />
[2] Chase, H. LangChain, 2022.<br />
[3] Weng, L. LLM-powered Autonomous Agents, 2023.<br />
[4] Plotkin, G. D., Power, A. J. Algebraic Effects, 2003.<br />
[5] ML105: Agentic AI Curriculum.</p>
<hr />
<h2 id="appendix-a.-agentspec-grammar-summary">Appendix A. AgentSpec
Grammar (Summary)</h2>
<pre class="ebnf"><code>AgentSpec ::= MetaDef SystemDef
SystemDef ::= &quot;system&quot; Name &quot;{&quot; ComponentDef* &quot;}&quot;
ComponentDef ::= &quot;component&quot; Name &quot;{&quot; MemberDef* &quot;}&quot;
MemberDef ::= &quot;state&quot; Name &quot;{&quot; Field* &quot;}&quot;
           | &quot;function&quot; Name &quot;(&quot; Params &quot;)&quot; &quot;-&gt;&quot; Type
           | &quot;effect&quot; Name
           | &quot;workflow&quot; Name
           | &quot;invariant&quot; StringLiteral</code></pre>
</body>
</html>
